/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license RequireJS text 2.0.5+ Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(){var e,t,i;(function(r){function n(e,t){return y.call(e,t)}function s(e,t){var i,r,n,s,a,o,l,u,c,p,f=t&&t.split("/"),d=h.map,w=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(f=f.slice(0,f.length-1),e=f.concat(e.split("/")),u=0;e.length>u;u+=1)if(p=e[u],"."===p)e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||w)&&d){for(i=e.split("/"),u=i.length;u>0;u-=1){if(r=i.slice(0,u).join("/"),f)for(c=f.length;c>0;c-=1)if(n=d[f.slice(0,c).join("/")],n&&(n=n[r])){s=n,a=u;break}if(s)break;!o&&w&&w[r]&&(o=w[r],l=u)}!s&&o&&(s=o,a=l),s&&(i.splice(0,a,s),e=i.join("/"))}return e}function a(e,t){return function(){return d.apply(r,x.call(arguments,0).concat([e,t]))}}function o(e){return function(t){return s(t,e)}}function l(e){return function(t){b[e]=t}}function u(e){if(n(m,e)){var t=m[e];delete m[e],v[e]=!0,f.apply(r,t)}if(!n(b,e)&&!n(v,e))throw Error("No "+e);return b[e]}function c(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function p(e){return function(){return h&&h.config&&h.config[e]||{}}}var f,d,w,g,b={},m={},h={},v={},y=Object.prototype.hasOwnProperty,x=[].slice;w=function(e,t){var i,r=c(e),n=r[0];return e=r[1],n&&(n=s(n,t),i=u(n)),n?e=i&&i.normalize?i.normalize(e,o(t)):s(e,t):(e=s(e,t),r=c(e),n=r[0],e=r[1],n&&(i=u(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:i}},g={require:function(e){return a(e)},exports:function(e){var t=b[e];return t!==void 0?t:b[e]={}},module:function(e){return{id:e,uri:"",exports:b[e],config:p(e)}}},f=function(e,t,i,s){var o,c,p,f,d,h,y=[];if(s=s||e,"function"==typeof i){for(t=!t.length&&i.length?["require","exports","module"]:t,d=0;t.length>d;d+=1)if(f=w(t[d],s),c=f.f,"require"===c)y[d]=g.require(e);else if("exports"===c)y[d]=g.exports(e),h=!0;else if("module"===c)o=y[d]=g.module(e);else if(n(b,c)||n(m,c)||n(v,c))y[d]=u(c);else{if(!f.p)throw Error(e+" missing "+c);f.p.load(f.n,a(s,!0),l(c),{}),y[d]=b[c]}p=i.apply(b[e],y),e&&(o&&o.exports!==r&&o.exports!==b[e]?b[e]=o.exports:p===r&&h||(b[e]=p))}else e&&(b[e]=i)},e=t=d=function(e,t,i,n,s){return"string"==typeof e?g[e]?g[e](t):u(w(e,t).f):(e.splice||(h=e,t.splice?(e=t,t=i,i=null):e=r),t=t||function(){},"function"==typeof i&&(i=n,n=s),n?f(r,e,t,i):setTimeout(function(){f(r,e,t,i)},4),d)},d.config=function(e){return h=e,h.deps&&d(h.deps,h.callback),d},i=function(e,t,i){t.splice||(i=t,t=[]),n(b,e)||n(m,e)||(m[e]=[e,t,i])},i.amd={jQuery:!0}})(),i("almond",function(){}),i("waterfall-subscription-widget/console",[],function(){function e(e){return function(){var t=Array.prototype.join.call(arguments,"");return window.console[e]("waterfall-subscription-widget: "+t)}}for(var t,i=function(){},r={},n=["debug","log","error"],s=0;n.length>s;s++)t=n[s],r[t]=window.console?e(t):i;return r}),i("waterfall-subscription-widget/dom",["waterfall-subscription-widget/console"],function(e){function t(e,t){return"string"==typeof e&&(t=e,e=document),e.querySelector(t)}function i(e,t){return"string"==typeof e&&(t=e,e=document),e.querySelectorAll(t)}function r(e,t){var i=e.parentElement.querySelectorAll(t),r=0;do{if(i[r]===e)return!0;r++}while(i.length>r);return!1}function n(e,t){var i=e.parentElement;return i?r(i,t)?i:n(i,t):null}function s(t,i,r,n){return t?t.addEventListener?t.addEventListener(i,r,n):t.attachEvent?t.attachEvent(i,r):(e.error("el",t,"cannot listen to events"),!1):(e.error("cannot hook non-existent element"),!1)}function a(e,t){for(var i=e.className.split(" "),r=0;i.length>r;r++)if(i[r]===t)return!0;return!1}function o(e,t){var i=e.className.split(" ");a(e,t)||(i.push(t),e.className=i.join(" "))}function l(e,t){for(var i=e.className.split(" "),r=[],n=0;i.length>n;n++)i[n]!==t&&r.push(i[n]);e.className=r.join(" ")}return{qs:t,qsa:i,matches:r,closest:n,hook:s,hasClass:a,addClass:o,removeClass:l}}),i("text",["module"],function(e){var i,r,n,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,c=u&&location.protocol&&location.protocol.replace(/\:/,""),p=u&&location.hostname,f=u&&(location.port||void 0),d=[],w=e.config&&e.config()||{};return i={version:"2.0.5+",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:w.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=a[t];try{e=new ActiveXObject(i)}catch(r){}if(e){a=[i];break}}return e},parseName:function(e){var t,i,r,n=!1,s=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==s&&(!a||s>1)?(t=e.substring(0,s),i=e.substring(s+1,e.length)):t=e,r=i||t,s=r.indexOf("!"),-1!==s&&(n="strip"===r.substring(s+1),r=r.substring(0,s),i?i=r:t=r),{moduleName:t,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,r,n){var s,a,o,l=i.xdRegExp.exec(e);return l?(s=l[2],a=l[3],a=a.split(":"),o=a[1],a=a[0],!(s&&s!==t||a&&a.toLowerCase()!==r.toLowerCase()||(o||a)&&o!==n)):!0},finishLoad:function(e,t,r,n){r=t?i.strip(r):r,w.isBuild&&(d[e]=r),n(r)},load:function(e,t,r,n){if(n.isBuild&&!n.inlineText)return r(),void 0;w.isBuild=n.isBuild;var s=i.parseName(e),a=s.moduleName+(s.ext?"."+s.ext:""),o=t.toUrl(a),l=w.useXhr||i.useXhr;!u||l(o,c,p,f)?i.get(o,function(t){i.finishLoad(e,s.strip,t,r)},function(e){r.error&&r.error(e)}):t([a],function(e){i.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,t,r){if(d.hasOwnProperty(t)){var n=i.jsEscape(d[t]);r.asModule(e+"!"+t,"define(function () { return '"+n+"';});\n")}},writeFile:function(e,t,r,n,s){var a=i.parseName(t),o=a.ext?"."+a.ext:"",l=a.moduleName+o,u=r.toUrl(a.moduleName+o)+".js";i.load(l,r,function(){var t=function(e){return n(u,e)};t.asModule=function(e,t){return n.asModule(e,u,t)},i.write(e,l,t,s)},s)}},"node"===w.env||!w.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(r=t.nodeRequire("fs"),i.get=function(e,t){var i=r.readFileSync(e,"utf8");0===i.indexOf("ï»¿")&&(i=i.substring(1)),t(i)}):"xhr"===w.env||!w.env&&i.createXhr()?i.get=function(e,t,r,n){var s,a=i.createXhr();if(a.open("GET",e,!0),n)for(s in n)n.hasOwnProperty(s)&&a.setRequestHeader(s.toLowerCase(),n[s]);w.onXhr&&w.onXhr(a,e),a.onreadystatechange=function(){var i,n;4===a.readyState&&(i=a.status,i>399&&600>i?(n=Error(e+" HTTP status: "+i),n.xhr=a,r(n)):t(a.responseText))},a.send(null)}:"rhino"===w.env||!w.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?i.get=function(e,t){var i,r,n="utf-8",s=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),n)),l="";try{for(i=new java.lang.StringBuffer,r=o.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),i.append(r);null!==(r=o.readLine());)i.append(a),i.append(r);l=""+i+""}finally{o.close()}t(l)}:("xpconnect"===w.env||!w.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),i.get=function(e,t){var i,r,a={},o=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),i.init(o,1,0,!1),r=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),r.init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(i.available(),a),r.close(),i.close(),t(a.value)}catch(l){throw Error((o&&o.path||"")+": "+l)}}),i}),i("text!templates/subscription-widget.template.html",[],function(){return'<div class="waterfall-subscription-widget-root"><label><span>Mobile Number:</span><input class="waterfall-subscription-widget-area-code" type="tel" placeholder="512" maxlength="3" pattern="[0-9]{3}" required=""><input class="waterfall-subscription-widget-prefix" type="tel" placeholder="555" maxlength="3" pattern="[0-9]{3}" required=""><input class="waterfall-subscription-widget-line-no" type="tel" placeholder="1234" maxlength="4" pattern="[0-9]{4}" required=""></label><button class="waterfall-subscription-widget-submit-btn" type="button">Sign Up</button><p class="waterfall-subscription-widget-result"></p><p>Message and Data Rates May Apply</p><p>Service is compatible with most handsets. To unsubscribe at any time simply text&nbsp;<strong>STOP</strong>&nbsp;to 67463. For help, please send&nbsp;<strong>HELP</strong>&nbsp;to 67463 or contact us at support@msgme.com or 866-251-1200. Message frequency: No more than 30 message per month.</p><iframe src="/test/assets/subscribe-frame.html"></iframe></div>'}),i("text!css/subscription-widget.css",[],function(){return'.waterfall-subscription-widget{/*! normalize.css v2.1.0 | MIT License | git.io/normalize */}.waterfall-subscription-widget article,.waterfall-subscription-widget aside,.waterfall-subscription-widget details,.waterfall-subscription-widget figcaption,.waterfall-subscription-widget figure,.waterfall-subscription-widget footer,.waterfall-subscription-widget header,.waterfall-subscription-widget hgroup,.waterfall-subscription-widget main,.waterfall-subscription-widget nav,.waterfall-subscription-widget section,.waterfall-subscription-widget summary{display:block}.waterfall-subscription-widget audio,.waterfall-subscription-widget canvas,.waterfall-subscription-widget video{display:inline-block}.waterfall-subscription-widget audio:not([controls]){display:none;height:0}.waterfall-subscription-widget [hidden]{display:none}.waterfall-subscription-widget html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}.waterfall-subscription-widget body{margin:0}.waterfall-subscription-widget a:focus{outline:thin dotted}.waterfall-subscription-widget a:active,.waterfall-subscription-widget a:hover{outline:0}.waterfall-subscription-widget h1{font-size:2em;margin:.67em 0}.waterfall-subscription-widget abbr[title]{border-bottom:1px dotted}.waterfall-subscription-widget b,.waterfall-subscription-widget strong{font-weight:bold}.waterfall-subscription-widget dfn{font-style:italic}.waterfall-subscription-widget hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}.waterfall-subscription-widget mark{background:#ff0;color:#000}.waterfall-subscription-widget code,.waterfall-subscription-widget kbd,.waterfall-subscription-widget pre,.waterfall-subscription-widget samp{font-family:monospace,serif;font-size:1em}.waterfall-subscription-widget pre{white-space:pre-wrap}.waterfall-subscription-widget q{quotes:"\\201C" "\\201D" "\\2018" "\\2019"}.waterfall-subscription-widget small{font-size:80%}.waterfall-subscription-widget sub,.waterfall-subscription-widget sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.waterfall-subscription-widget sup{top:-0.5em}.waterfall-subscription-widget sub{bottom:-0.25em}.waterfall-subscription-widget img{border:0}.waterfall-subscription-widget svg:not(:root){overflow:hidden}.waterfall-subscription-widget figure{margin:0}.waterfall-subscription-widget fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:.35em .625em .75em}.waterfall-subscription-widget legend{border:0;padding:0}.waterfall-subscription-widget button,.waterfall-subscription-widget input,.waterfall-subscription-widget select,.waterfall-subscription-widget textarea{font-family:inherit;font-size:100%;margin:0}.waterfall-subscription-widget button,.waterfall-subscription-widget input{line-height:normal}.waterfall-subscription-widget button,.waterfall-subscription-widget select{text-transform:none}.waterfall-subscription-widget button,.waterfall-subscription-widget html input[type="button"],.waterfall-subscription-widget input[type="reset"],.waterfall-subscription-widget input[type="submit"]{-webkit-appearance:button;cursor:pointer}.waterfall-subscription-widget button[disabled],.waterfall-subscription-widget html input[disabled]{cursor:default}.waterfall-subscription-widget input[type="checkbox"],.waterfall-subscription-widget input[type="radio"]{box-sizing:border-box;padding:0}.waterfall-subscription-widget input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}.waterfall-subscription-widget input[type="search"]::-webkit-search-cancel-button,.waterfall-subscription-widget input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}.waterfall-subscription-widget button::-moz-focus-inner,.waterfall-subscription-widget input::-moz-focus-inner{border:0;padding:0}.waterfall-subscription-widget textarea{overflow:auto;vertical-align:top}.waterfall-subscription-widget table{border-collapse:collapse;border-spacing:0}.waterfall-subscription-widget label>*{margin-right:.5em}.waterfall-subscription-widget input.waterfall-subscription-widget-area-code,.waterfall-subscription-widget input.waterfall-subscription-widget-prefix{text-align:center;width:1.7999999999999998em}.waterfall-subscription-widget input.waterfall-subscription-widget-line-no{text-align:center;width:2.4em}.waterfall-subscription-widget iframe{width:0;height:0;display:none}.waterfall-subscription-widget .waterfall-subscription-widget-result{display:none}.waterfall-subscription-widget .waterfall-subscription-widget-result.waterfall-subscription-widget-success,.waterfall-subscription-widget .waterfall-subscription-widget-result.waterfall-subscription-widget-failure{display:block}'}),i("waterfall-subscription-widget/inject",["waterfall-subscription-widget/dom","text!templates/subscription-widget.template.html","text!css/subscription-widget.css"],function(e,t,i){function r(){var r=document.createElement("style");r.className="waterfall-subscription-widget-styles",r.innerHTML=i,document.querySelector("head").appendChild(r);var s,a,o=document.querySelectorAll(".waterfall-subscription-widget");for(s=0;o.length>s;s++)a=o[s],a.id="waterfall-subscription-widget-"+n,a.innerHTML=t,e.qs(a,"iframe").src+="#"+a.id,n++}var n=0;return r}),i("waterfall-subscription-widget",["waterfall-subscription-widget/console","waterfall-subscription-widget/dom","waterfall-subscription-widget/inject"],function(e,t,i){function r(e){return e?w+"-"+e:e}function n(e){return"."+w+e}function s(e){var t=e.getAttribute("pattern");return A[t]||(A[t]=RegExp(t)),A[t].test(e.value)}function a(e){if(t.matches(e,j)){var i=s(e);return i?t.removeClass(e,v):t.addClass(e,v),i}}function o(e){for(var i=t.qsa(e,j),r=null,n=0;i.length>n;n++)a(i[n])||null!==r||(r=n);return null!==r?(i[r].focus(),t.addClass(e,v)):t.removeClass(e,v),null===r}function l(e){var i=t.qs(e,n("-area-code")),r=t.qs(e,n("-prefix")),s=t.qs(e,n("-line-no"));return i.value+r.value+s.value}function u(e){var i=e.getAttribute(h),r=e.getAttribute(b),n=t.qs(e,"iframe");n.contentWindow.postMessage(JSON.stringify({type:"subscribe",listId:r,mobileNumber:i}),n.src),e.removeAttribute(h)}function c(i){var r,n;try{if(n=JSON.parse(i.data),!n.id)return e.error("Message with no id specified: "+i.data),void 0;r=t.qs("#"+n.id),z[n.type]?z[n.type](n,r):e.error('Unexpected message type "'+n.type+'": '+i.data)}catch(s){e.error('Failed to handle message "'+i.data+'": '+s.message)}}function p(e){var i=t.closest(e.target,q),n=t.qs(i,k),s=t.qs(i,C);t.removeClass(s,y),t.removeClass(s,x),o(i)&&(n.setAttribute("disabled",!0),t.addClass(i,r("busy")),i.setAttribute(h,l(i)),"true"===i.getAttribute(m)&&u(i))}function f(e){a(e.target)}function d(){var e;i(),e=t.qsa(q);for(var r=0;e.length>r;r++)t.hook(e[r],"blur",f,!0),t.hook(e[r],"change",f,!0),t.hook(t.qs(e[r],k),"click",p),t.hook(window,"message",c)}var w="waterfall-subscription-widget",g="data-waterfall-",b=g+"listid",m=g+"ready",h=g+"pending-mobile-number",v=r("invalid"),y=r("success"),x=r("failure"),q=n(""),k=n("-submit-btn"),C=n("-result"),j=n(" input"),A={},z={};if(z.ready=function(e,t){t.setAttribute(m,!0),t.hasAttribute(h)&&u(t)},z.result=function(e,i){var n,s,a=t.qs(i,C);if(t.removeClass(i,r("busy")),t.qs(i,k).removeAttribute("disabled"),a.innerHTML=e.message,e.success){for(n=t.qsa(i,j),s=0;n.length>s;s++)n[s].value="";t.addClass(a,y)}else t.addClass(a,x)},!document)return e.error("no `document` in scope"),void 0;var E=null,L=t.qs("script["+b+"]");return L?(E=L.getAttribute(b),L.removeAttribute(b),"complete"!==document.readyState?t.hook(window,"load",d):d(),void 0):(e.error(w+": could not find a script with a"+"`data-waterfall-listid` attribute"),void 0)}),t("waterfall-subscription-widget")})();